@model MenuItem
@{
    ViewData["Title"] = "Create Menu Item";
    Layout = "_AdminLayout";
}

@section Styles {
    <link rel="stylesheet" href="~/css/admin-styles.css" />
}

<!-- Top Bar -->
<header class="top-bar">
    <div class="top-bar-left">
        <div class="breadcrumb">
            <a asp-action="Index">Dashboard</a>
            <i class="fas fa-chevron-right"></i>
            <a asp-action="Menu">Menu Management</a>
            <i class="fas fa-chevron-right"></i>
            <span>Create Menu Item</span>
        </div>
        <h1>Create Menu Item</h1>
        <p>Add a new item to your restaurant menu</p>
    </div>
    <div class="top-bar-right">
        <div class="quick-actions">
            <a asp-action="Menu" class="btn-secondary">
                <i class="fas fa-arrow-left"></i>
                Back to Menu
            </a>
        </div>
    </div>
</header>

<!-- Floating Success Message -->
@if (TempData["SuccessMessage"] != null)
{
    <div id="floatingSuccessMessage" class="floating-success-message">
        <i class="fas fa-check-circle"></i>
        @TempData["SuccessMessage"]
    </div>
}

<!-- Floating Error Message -->
@if (TempData["ErrorMessage"] != null)
{
    <div id="floatingErrorMessage" class="floating-error-message">
        <i class="fas fa-exclamation-circle"></i>
        @TempData["ErrorMessage"]
    </div>
}

<!-- Create Menu Item Content -->
<section class="create-content">
    <div class="content-grid">
        <!-- Main Form -->
        <div class="form-section">
            <div class="form-card">
                <div class="form-header">
                    <h3>
                        <i class="fas fa-utensils"></i>
                        Menu Item Details
                    </h3>
                    <p>Fill in the details for your new menu item</p>
                </div>
                
                <form asp-action="CreateMenuItem" method="post" enctype="multipart/form-data" class="create-form">
                    <div asp-validation-summary="ModelOnly" class="validation-summary"></div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label asp-for="CategoryId" class="form-label">
                                <i class="fas fa-tags"></i>
                                Category
                            </label>
                            <select asp-for="CategoryId" class="form-select">
                                <option value="">Select Category</option>
                                @if (ViewBag.Categories != null)
                                {
                                    @foreach (var category in ViewBag.Categories)
                                    {
                                        <option value="@category.Id">@category.Name</option>
                                    }
                                }
                            </select>
                            <span asp-validation-for="CategoryId" class="field-validation"></span>
                            <div class="form-help">Item ID will be auto-generated based on category (M001, S001, D001, B001)</div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label asp-for="Name" class="form-label">
                                <i class="fas fa-utensils"></i>
                                Item Name
                            </label>
                            <input asp-for="Name" class="form-input" placeholder="Enter item name" />
                            <span asp-validation-for="Name" class="field-validation"></span>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label asp-for="Description" class="form-label">
                                <i class="fas fa-align-left"></i>
                                Description <span class="optional-text">(Optional)</span>
                            </label>
                            <textarea asp-for="Description" class="form-textarea" rows="4" placeholder="Enter item description (optional)"></textarea>
                            <span asp-validation-for="Description" class="field-validation"></span>
                        </div>
                    </div>

                    <div class="form-row two-columns">
                        <div class="form-group">
                            <label asp-for="Price" class="form-label">
                                <i class="fas fa-dollar-sign"></i>
                                Price
                            </label>
                            <div class="price-input-group">
                                <span class="currency-symbol">$</span>
                                <input asp-for="Price" class="form-input" type="number" step="0.01" min="0" placeholder="0.00" />
                            </div>
                            <span asp-validation-for="Price" class="field-validation"></span>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-toggle-on"></i>
                                Availability
                            </label>
                            <div class="switch-container">
                                <label class="switch">
                                    <input asp-for="IsAvailable" type="checkbox" checked />
                                    <span class="slider round"></span>
                                </label>
                                <span class="switch-label">Available for ordering</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label asp-for="ImageFile" class="form-label">
                                <i class="fas fa-image"></i>
                                Item Image
                            </label>
                            <div class="file-upload-container">
                                <input asp-for="ImageFile" class="file-input" type="file" accept="image/*" id="imageUpload" />
                                <label for="imageUpload" class="file-upload-label">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                    <span>Choose Image</span>
                                </label>
                            </div>
                            <span asp-validation-for="ImageFile" class="field-validation"></span>
                            <div class="form-help">Upload an image for this menu item (JPG, PNG, GIF)</div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-save"></i>
                            Create Menu Item
                        </button>
                        <a asp-action="Menu" class="btn-secondary">
                            <i class="fas fa-times"></i>
                            Cancel
                        </a>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Sidebar -->
        <div class="sidebar-section">
            <!-- Image Preview Card -->
            <div class="sidebar-card">
                <div class="sidebar-header">
                    <h4>
                        <i class="fas fa-eye"></i>
                        Image Preview
                    </h4>
                </div>
                <div class="sidebar-content">
                    <div id="imagePreview" class="image-preview" style="display: none;">
                        <img id="previewImg" alt="Preview" />
                    </div>
                    <div id="noImageText" class="no-image-placeholder">
                        <i class="fas fa-image"></i>
                        <p>No image selected</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

@section Scripts {
    <script>
        // Image preview functionality
        document.querySelector('input[type="file"]').addEventListener('change', function(e) {
            const file = e.target.files[0];
            const preview = document.getElementById('imagePreview');
            const previewImg = document.getElementById('previewImg');
            const noImageText = document.getElementById('noImageText');

            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    previewImg.src = e.target.result;
                    preview.style.display = 'block';
                    noImageText.style.display = 'none';
                };
                reader.readAsDataURL(file);
            } else {
                preview.style.display = 'none';
                noImageText.style.display = 'block';
            }
        });

        // Auto-hide floating messages after 3 seconds
        document.addEventListener('DOMContentLoaded', function() {
            const floatingMessage = document.getElementById('floatingSuccessMessage');
            const floatingError = document.getElementById('floatingErrorMessage');
            
            if (floatingMessage) {
                setTimeout(function() {
                    floatingMessage.style.animation = 'slideOutRight 0.3s ease-in';
                    setTimeout(function() {
                        floatingMessage.remove();
                    }, 300);
                }, 3000);
            }
            
            if (floatingError) {
                setTimeout(function() {
                    floatingError.style.animation = 'slideOutRight 0.3s ease-in';
                    setTimeout(function() {
                        floatingError.remove();
                    }, 300);
                }, 5000);
            }
        });
    </script>
    
}